<%# ヘッダー中央タイトルは content_for を使っている前提 %>
<% content_for :page_title do %>
  <%= @category[:title] %>
<% end %>

<%# デバッグ表示：params で何が選ばれたか一目で分かるようにする %>
<% if @selected_item.present? %>
  <div class="mb-4 rounded-xl border border-amber-300 bg-white px-4 py-3 text-sm text-stone-700">
    選択された項目：<%= @selected_item[:name] %>（key=<%= @selected_item[:key] %>）
  </div>
<% end %>

<div class="grid grid-cols-2 gap-4">
  <% @items.each do |item| %>
    <% selected = (@selected_item.present? && @selected_item[:key] == item[:key]) %>

    <%= link_to category_flow_path(category_id: params[:category_id], item: item[:key]),
                class: "block" do %>
      <div class="bg-card-light dark:bg-card-dark rounded-xl p-6 flex flex-col items-center justify-center text-center shadow-soft hover:shadow-md transition-shadow active:scale-95 duration-200 aspect-square group #{selected ? 'ring-2 ring-amber-400' : ''}">
        <span class="material-icons-round text-5xl mb-3 text-orange-500 group-hover:scale-110 transition-transform">
          <%= item[:icon] %>
        </span>

        <span class="text-2xl font-bold text-text-main-light dark:text-text-main-dark mb-1">
          <%= item[:name] %>
        </span>

        <span class="text-sm text-text-sub-light dark:text-text-sub-dark">
          <%= item[:kana] %>
        </span>
      </div>
    <% end %>
  <% end %>
</div>
